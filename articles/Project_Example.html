<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Statistical Computing: Coursework project example">
<title>StatComp Project Example: Numerical statistics • StatCompLab</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="StatComp Project Example: Numerical statistics">
<meta property="og:description" content="Statistical Computing: Coursework project example">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">StatCompLab</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">23.4.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Project01.html">StatComp Project 1 (2022/23): Simulation and sampling</a>
    <a class="dropdown-item" href="../articles/Project01Hints.html">StatComp Project 1 (2022/23): Hints</a>
    <a class="dropdown-item" href="../articles/Tutorial01.html">Tutorial 01: R and linear models</a>
    <a class="dropdown-item" href="../articles/Tutorial01Solutions.html">Tutorial 01: R and linear models (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial02.html">Tutorial 02: Optimization</a>
    <a class="dropdown-item" href="../articles/Tutorial02Solutions.html">Tutorial 02: Optimization (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial03.html">Tutorial 03: Monte Carlo integration</a>
    <a class="dropdown-item" href="../articles/Tutorial03Solutions.html">Tutorial 03: Monte Carlo integration (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial04.html">Tutorial 04: Uncertainty and integration</a>
    <a class="dropdown-item" href="../articles/Tutorial04Solutions.html">Tutorial 04: Uncertainty and integration (solutions)</a>
    <a class="dropdown-item" href="../articles/Project_Example.html">StatComp Project Example: Numerical statistics</a>
    <a class="dropdown-item" href="../articles/Project_Example_Solution.html">StatComp Project Example Solution: Numerical Statistics</a>
    <a class="dropdown-item" href="../articles/Quiz1Solution.html">Quiz 1 Solution (StatComp 2021/22)</a>
    <a class="dropdown-item" href="../articles/T4sol.html">Tutorial 04: Uncertainty and integration (full solution)</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/finnlindgren/StatCompLab/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>StatComp Project Example: Numerical statistics</h1>
                        <h4 data-toc-skip class="author">Finn
Lindgren</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/finnlindgren/StatCompLab/blob/HEAD/vignettes/articles/Project_Example.Rmd" class="external-link"><code>vignettes/articles/Project_Example.Rmd</code></a></small>
      <div class="d-none name"><code>Project_Example.Rmd</code></div>
    </div>

    
    
<ol style="list-style-type: decimal">
<li>These were instructions for this example project; the projects this
year will have different instructions that you should follow instead.
The instructions here are only meant to be used to understand why the
solution does technical things in the specific way it does. For your own
project, make sure to follow the relevant instructons instead.</li>
<li>Your project repository contains a template RMarkdown document,
<code>report.Rmd</code>, that you should expand with your answers and
solutions for this project assignment, and two code files,
<code>code.R</code> containing some predefined functions, and
<code>my_code.R</code> that should be used for some of your own code. Do
not change these filenames.</li>
<li>Some of the code solutions (as indicated for those items) should be
placed in the <code>my_code.R</code> file, and included in the report as
indicated in the template document (also see the
<code>RMdemo.Rmd</code>, <code>my_code.R</code>, and
<code>T4sol.Rmd</code> document examples from the Week 4 lecture and
example materials on Learn).</li>
<li>Code that is placed directly into code chunks in the
<code>report.Rmd</code> file should be shown in a separate section at
the end of the report, so that the main text is a coherent presentation
of theory and discussion of methods and results. In the code
presentation section, include a brief code comment for each chunk. Also
include brief documentation as code comments before each function
defined in <code>my_code.R</code>.</li>
<li>The <code>styler</code> package Addin for restyling code for better
and consistent readability works for both <code>.R</code> and
<code>.Rmd</code> files.</li>
</ol>
<p>The assignment is submitted by pushing your work to the github
repository before your submission deadline. Make sure you include your
name, student number, and github username in both
<code>report.Rmd</code> and <code>my_code.R</code>. When submitting,
also include a generated html version of the report, with filename
<code>report.html</code>. Normally, generated images are automatically
included in the html file itself; otherwise they need to be added to the
repository as well.</p>
<p>It is strongly recommended to commit and push to github frequently.
If you’re uncertain about whether you’re pushing all the needed
submission files to github, ask Finn to check the repository contents
<em>at least</em> a week before the submisison deadline.</p>
<p>The 10 sub-tasks contribute equally to the total mark, but the
project will be marked as a whole, between <span class="math inline">\(0\)</span> and <span class="math inline">\(40\)</span>. A marking guide will be posted on
Learn.</p>
<div style="page-break-after: always;"></div>
<div class="section level2">
<h2 id="archaeology-in-the-baltic-sea">Archaeology in the Baltic Sea<a class="anchor" aria-label="anchor" href="#archaeology-in-the-baltic-sea"></a>
</h2>
<p>In Lab 3, you investigated data from an archaeological excavation on
Gotland in the Baltic sea. In the 1920s, a battle gravesite from 1361
was subject to several archaeological excavations. A total of <span class="math inline">\(493\)</span> femurs (thigh bones) (<span class="math inline">\(256\)</span> left, and <span class="math inline">\(237\)</span> right) were found. We wanted to
figure out how many persons were likely buried at the gravesite. It must
reasonably have been at least <span class="math inline">\(256\)</span>,
but how many more? In this assignment, you will use importance sampling
to estimate credible intervals for this problem.</p>
<p>In the lab, it seemed difficult to extract much information from the
sample, since there were only two observations and two parameters. You
will here investigate if including data from other excavations of the
same type might decrease the uncertainty about the number of persons
buried, through improved information about the average detection
probability, <span class="math inline">\(\phi\)</span>. The function
<code>arch_data</code> in <code>code.R</code> returns a data frame with
data for up to four different excavations (note: only one of them is
real; the other three are synthetic data generated for this
assignment).</p>
<p>We assume the same model as in the lab for each excavation, with an
unknown <span class="math inline">\(N_j\)</span>, <span class="math inline">\(j=1,\dots,J\)</span>, for each of the <span class="math inline">\(J\)</span> excavations, and a common detection
probability <span class="math inline">\(\phi\)</span>. We assume them
model that, conditionally on <span class="math inline">\(\{N_j\}\)</span> and <span class="math inline">\(\phi\)</span>, <span class="math inline">\((Y_{j,i}|N_j,\phi)\sim\mathsf{Bin}(N_j,\phi)\)</span>,
<span class="math inline">\(i=1,2\)</span>, all independent, and prior
distributions <span class="math inline">\(N_j\sim\mathsf{Geom}(\xi)\)</span>, <span class="math inline">\(0&lt;\xi&lt;1\)</span>, and <span class="math inline">\(\phi\sim\mathsf{Beta}(a, b)\)</span>, <span class="math inline">\(a,b&gt;0\)</span>, <span class="math display">\[
\begin{aligned}
p_{Y_{j,i}|N_j=n,\phi}(y) = \mathsf{P}(Y_{j,i}=y|N_j=n,\phi) &amp;= {n
\choose y} \phi^y(1-\phi)^{n-y},
\quad y=0,\dots,n, \\
p_{N_j}(n) = \mathsf{P}(N_j=n) &amp;= \xi\,(1-\xi)^n,\quad
n=0,1,2,3,\dots, \\
p_\phi(\phi) &amp;= \frac{\phi^{a-1}(1-\phi)^{b-1}}{B(a,b)}, \quad
\phi\in(0,1) ,
\end{aligned}
\]</span> where <span class="math inline">\(B(a,b)\)</span> is the
<em>Beta function</em>, see <code><a href="https://rdrr.io/r/base/Special.html" class="external-link">?beta</a></code> in R.</p>
<div class="section level3">
<h3 id="joint-probability-function-for-boldsymbolnboldsymboly">Joint probability function for <span class="math inline">\((\boldsymbol{N},\boldsymbol{Y})\)</span><a class="anchor" aria-label="anchor" href="#joint-probability-function-for-boldsymbolnboldsymboly"></a>
</h3>
<p>Conditionally on <span class="math inline">\(\boldsymbol{N}=\{N_1,\dots,N_J\}\)</span>, and the
observations <span class="math inline">\(\boldsymbol{Y}\)</span>, the
conditional posterior distribution for <span class="math inline">\((\phi|\boldsymbol{N},\boldsymbol{Y})\)</span> is
<span class="math inline">\(\mathsf{Beta}(\widetilde{a},\widetilde{b})\)</span>
where <span class="math inline">\(\widetilde{a}=a+\sum_{j,i}
Y_{j,i}\)</span> and <span class="math inline">\(\widetilde{b}=b+2\sum_j
N_j -\sum_{j,i} Y_{j,i}\)</span>, and the sums go over <span class="math inline">\(j=1,\dots,J\)</span> and <span class="math inline">\(i=1,2\)</span>.</p>
<p>Show that the joint probability function for <span class="math inline">\((\boldsymbol{N},\boldsymbol{Y})\)</span>, with
<span class="math inline">\(N_j\geq\max(Y_{j,1},Y_{j,2})\)</span> and
<span class="math inline">\(Y_{j,i}=0,1,2,\dots\)</span>, is given by<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Binomial coefficients can be notated with
&lt;code&gt;{N \choose k}&lt;/code&gt; in LaTeX formulas.&lt;/p&gt;"><sup>1</sup></a> <span class="math display">\[
p(\boldsymbol{N},\boldsymbol{Y}) =
\frac{B(\widetilde{a},\widetilde{b})}{B(a,b)} \prod_{j=1}^J \left[
p(N_j)
\prod_{i=1}^2
{N_j \choose Y_{j,i}}
\right],
\]</span> where <span class="math inline">\(p(N_j)\)</span> is the
probability mass function for the Geometric distribution prior for <span class="math inline">\(N_j\)</span>.</p>
</div>
<div class="section level3">
<h3 id="probability-function-implementation">Probability function implementation<a class="anchor" aria-label="anchor" href="#probability-function-implementation"></a>
</h3>
<p>With the help of the functions <code>lbeta</code>,
<code>lchoose</code>, and <code>dgeom</code>, define (in
<code>my_code.R</code>) a function <code>log_prob_NY(N,Y,xi,a,b)</code>
with arguments <code>N</code> (a vector of length <span class="math inline">\(J\)</span>) and <span class="math inline">\(Y\)</span> (a data frame of size <span class="math inline">\(J\times 2\)</span>, formatted like the output from
<code>arch_data(J)</code>). The arguments <code>xi</code>,
<code>a</code>, <code>b</code> are the model hyperparameters <span class="math inline">\(\xi\)</span>, <span class="math inline">\(a\)</span>, and <span class="math inline">\(b\)</span>. The function should return the
logarithm of <span class="math inline">\(p(\boldsymbol{N},\boldsymbol{Y})\)</span> when the
combination of <span class="math inline">\(\boldsymbol{N}\)</span> and
<span class="math inline">\(\boldsymbol{Y}\)</span> is valid, and should
otherwise return <code>-Inf</code>.</p>
</div>
<div class="section level3">
<h3 id="importance-sampling-function">Importance sampling function<a class="anchor" aria-label="anchor" href="#importance-sampling-function"></a>
</h3>
<p>The aim is to construct a Bayesian credible interval for each <span class="math inline">\(N_j\)</span> using importance sampling, similarly
to the method used in lab 4. There, a Gaussian approximation of the
posterior of a parameter was used. Here, we will instead use the prior
distribution for <span class="math inline">\(\boldsymbol{N}\)</span> as
sampling distribution, with samples <span class="math inline">\(N_j^{[k]}\sim\mathsf{Geom}(\xi)\)</span>.</p>
<p>Since the observations <span class="math inline">\(\boldsymbol{Y}\)</span> are fixed, the posterior
probability function <span class="math inline">\(p(\boldsymbol{N}|\boldsymbol{Y})\)</span> for
<span class="math inline">\(\boldsymbol{N}\)</span> is proportional to
<span class="math inline">\(p(\boldsymbol{N},\boldsymbol{Y})\)</span>.</p>
<p>We define the logarithm of unnormalised importance weights, <span class="math inline">\(\log[w^{[k]}]=\log[p(\boldsymbol{N}^{[k]},\boldsymbol{Y})]-\log[p(\boldsymbol{N}^{[k]})]\)</span>,
where <span class="math inline">\(p(\boldsymbol{N}^{[k]})\)</span> is
the product of <span class="math inline">\(J\)</span> geometric
distribution probabilities.</p>
<p>Define (in <code>my_code.R</code>) a function
<code>arch_importance(K,Y,xi,a,b)</code> with the same arguments
<code>Y</code>, <code>xi</code>, <code>a</code>, and <code>b</code> as
before, but with the first argument <code>K</code> defining the number
of samples to generate. The function should return a data frame with
<span class="math inline">\(K\)</span> rows and <span class="math inline">\(J+1\)</span> columns, named <code>N1</code>,
<code>N2</code>, etc, for each <span class="math inline">\(j=1,\dots,J\)</span>, containing samples from the
prior distributions for <span class="math inline">\(N_j\)</span>, and a
final column called <code>Log_Weights</code>, containing re-normalised
log-importance-weights, constructed by shifting <span class="math inline">\(\log[w^{[k]}]\)</span> by subtracting the largest
<span class="math inline">\(\log[w^{[k]}]\)</span> value, as in lab
4.</p>
<div class="section level4">
<h4 id="more-efficient-alternative">More efficient alternative<a class="anchor" aria-label="anchor" href="#more-efficient-alternative"></a>
</h4>
<p>Using the <span class="math inline">\(\mathsf{Geom}(\xi)\)</span>
prior distribution for each <span class="math inline">\(N_j\)</span>
leads to a rather inefficient importance sampler, especially for <span class="math inline">\(J=4\)</span>; Most of the weights will become zero
(when some <span class="math inline">\(N_j^{[k]}&lt;Y_{j,i}\)</span>) or
near zeros, and only a few samples will influence the practical
estimates and credible intervals.</p>
<p>As an alternative, we can use sampling distributions that are better
adapted to the posterior distributions. Let <span class="math inline">\(N^\text{min}_j=\max(Y_{j,1}, Y_{j,2})\)</span> be
the smallest allowed value to sample, for each <span class="math inline">\(j=1,\dots,J\)</span>. This would eliminate all the
impossible combinations, so that all weights would be (in theory if not
numerically) positive.</p>
<p>To further improve the method, we can choose different values of the
probability parameter for the samples, and also adapt it differently for
each <span class="math inline">\(j\)</span>. Without motivation, you can
use values <span class="math inline">\(\xi_j=1/(1 + 4
N^\text{min}_j)\)</span> when sampling, so that <span class="math inline">\(N_j^{[k]}=N^\text{min}_j +
\mathsf{Geom}(\xi_j)\)</span>.</p>
<p>Note: Due to the nature of the geometric distribution, this is also
equivalent to an ordinary <span class="math inline">\(\mathsf{Geom}(\xi_j)\)</span> conditioned on being
at least <span class="math inline">\(N^\text{min}_j\)</span>.</p>
<p>To take this different sampling method into account, the log-weights
need to be defined as <span class="math inline">\(\log[w^{[k]}]=\log[p(\boldsymbol{N}^{[k]},\boldsymbol{Y})]-\log[\widetilde{p}(\boldsymbol{N}^{[k]})]\)</span>,
where <span class="math inline">\(\widetilde{p}(\boldsymbol{N}^{[k]})=\prod_{j=1}^J
p_{\mathsf{Geom}(\xi_j)}(N_j^{[k]}-N^\text{min}_j)\)</span>, the product
of <span class="math inline">\(J\)</span> different geometric
distribution probabilities.</p>
<p>You may adapt this example code (the details will depend on which
vectorisation method you use):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># matrix of minimum allowed N for each j, repeated K times</span></span>
<span><span class="va">N_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">Y</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">K</span><span class="op">)</span>, <span class="va">K</span>, <span class="va">J</span><span class="op">)</span></span>
<span><span class="va">xi_sample</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">N_min</span><span class="op">)</span></span>
<span><span class="co"># Sample values and call log_prob_NY for each sample,</span></span>
<span><span class="co"># store N-values in a K-by-J matrix, and log(p_NY)-values in a vector log_PY</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">rgeom</a></span><span class="op">(</span><span class="va">...</span>, prob <span class="op">=</span> <span class="va">xi_sample</span><span class="op">)</span>, <span class="va">K</span>, <span class="va">J</span><span class="op">)</span> <span class="op">+</span> <span class="va">N_min</span></span>
<span><span class="va">log_PY</span> <span class="op">&lt;-</span> <span class="va">...</span></span>
<span><span class="co"># Subtract the sampling log-probabilities</span></span>
<span><span class="va">log_PY</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">dgeom</a></span><span class="op">(</span><span class="va">N</span> <span class="op">-</span> <span class="va">N_min</span>, prob <span class="op">=</span> <span class="va">xi_sample</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Using this method, <span class="math inline">\(K\)</span> doesn’t
need to be larger than <span class="math inline">\(100000\)</span>, as
small as <span class="math inline">\(K=1000\)</span> starts to give
reasonable values for code testing purposes, and <span class="math inline">\(K=10000\)</span> should only take at most a few
seconds to run if the code is fully vectorised (the <code>vapply</code>
function can be used, but a basic <code>for</code>-loop is also fine in
this case).</p>
</div>
</div>
<div class="section level3">
<h3 id="credible-intervals-for-n_j">Credible intervals for <span class="math inline">\(N_j\)</span><a class="anchor" aria-label="anchor" href="#credible-intervals-for-n_j"></a>
</h3>
<p>As in the lab, let <span class="math inline">\(\xi=1/1001\)</span>,
and <span class="math inline">\(a=b=1/2\)</span>. Use
<code>arch_importance</code> and the <code>wquantile</code> function
with <code>type=1</code> (see the help text for information) to compute
credible intervals for <span class="math inline">\(N_j\)</span>. Start
by including only the data from a single excavation, and observe how the
interval for <span class="math inline">\(N_1\)</span> changes when data
from the other excavations are added. Present and discuss the
results.</p>
</div>
<div class="section level3">
<h3 id="credible-intervals-for-phi">Credible intervals for <span class="math inline">\(\phi\)</span><a class="anchor" aria-label="anchor" href="#credible-intervals-for-phi"></a>
</h3>
<p>Update<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Note: your final submission should only contain the
updated function.&lt;/p&gt;"><sup>2</sup></a> the <code>arch_importance</code> function
to add a column <code>Phi</code> with samples from the conditional
distribution <span class="math inline">\(\mathsf{Beta}(\widetilde{a},\widetilde{b})\)</span>
for each row of the importance sample. Use the updated function to
construct credible intervals for <span class="math inline">\(\phi\)</span>, one for <span class="math inline">\(J=1\)</span>, and one for <span class="math inline">\(J=4\)</span>. Present and discuss the results.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Finn Lindgren.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
