<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Statistical Computing (2021/22): Coursework project 2">
<title>StatComp Project 2 (2021/22): Scottish weather • StatCompLab</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="StatComp Project 2 (2021/22): Scottish weather">
<meta property="og:description" content="Statistical Computing (2021/22): Coursework project 2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">StatCompLab</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">21.9.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Project01.html">StatComp Project 1 (2021/22): Simulation and sampling</a>
    <a class="dropdown-item" href="../articles/Project01Hints.html">StatComp Project 1 (2021/22): Hints</a>
    <a class="dropdown-item" href="../articles/Project02.html">StatComp Project 2 (2021/22): Scottish weather</a>
    <a class="dropdown-item" href="../articles/Project02Hints.html">StatComp Project 2 (2021/22): Hints</a>
    <a class="dropdown-item" href="../articles/Tutorial01.html">Tutorial 01: R and linear models</a>
    <a class="dropdown-item" href="../articles/Tutorial01Solutions.html">Tutorial 01: R and linear models (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial02.html">Tutorial 02: Optimization</a>
    <a class="dropdown-item" href="../articles/Tutorial02Solutions.html">Tutorial 02: Optimization (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial03.html">Tutorial 03: Monte Carlo integration</a>
    <a class="dropdown-item" href="../articles/Tutorial03Solutions.html">Tutorial 03: Monte Carlo integration (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial04.html">Tutorial 04: Uncertainty and integration</a>
    <a class="dropdown-item" href="../articles/Tutorial04Solutions.html">Tutorial 04: Uncertainty and integration (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial06.html">Tutorial 06: Prediction assessment with proper scores</a>
    <a class="dropdown-item" href="../articles/Tutorial06Solutions.html">Tutorial 06: Prediction assessment with proper scores (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial07.html">Tutorial 07: Data wrangling and cross validation</a>
    <a class="dropdown-item" href="../articles/Tutorial07Solutions.html">Tutorial 07: Data wrangling and cross validation (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial08.html">Tutorial 08: Floating point computations and least squares</a>
    <a class="dropdown-item" href="../articles/Tutorial08Solutions.html">Tutorial 08: Floating point computations and least squares (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial09.html">Tutorial 09: Bootstrap and Pareto smoothed importance sampling</a>
    <a class="dropdown-item" href="../articles/Tutorial09Solutions.html">Tutorial 09: Bootstrap and Pareto smoothed importance sampling (solutions)</a>
    <a class="dropdown-item" href="../articles/Project_Example.html">StatComp Project Example: Numerical statistics</a>
    <a class="dropdown-item" href="../articles/Project_Example_Solution.html">StatComp Project Example Solution: Numerical Statistics</a>
    <a class="dropdown-item" href="../articles/Quiz1Solution.html">Quiz 1 Solution (StatComp 2021/22)</a>
    <a class="dropdown-item" href="../articles/T4sol.html">Tutorial 04: Uncertainty and integration (full solution)</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/finnlindgren/StatCompLab/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>StatComp Project 2 (2021/22): Scottish weather</h1>
                        <h4 data-toc-skip class="author">Finn Lindgren</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/finnlindgren/StatCompLab/blob/HEAD/vignettes/Project02.Rmd" class="external-link"><code>vignettes/Project02.Rmd</code></a></small>
      <div class="d-none name"><code>Project02.Rmd</code></div>
    </div>

    
    
<p>This document can either be accessed in html form on <a href="https://finnlindgren.github.io/StatCompLab/">https://finnlindgren.github.io/StatCompLab/</a>, as a vignette in <code>StatCompLab</code> version 21.9.3 or later, with <code><a href="../articles/Project02.html">vignette("Project02", "StatCompLab")</a></code>, or in pdf format on Learn.</p>
<ol style="list-style-type: decimal">
<li>You have been assigned a <code>project02-username</code> repository on <a href="https://github.com/StatComp21/" class="external-link">https://github.com/StatComp21/</a>. Use <code>git</code> to <em>clone</em> the repository (either to your own computer or <a href="https://rstudio.cloud" class="external-link">https://rstudio.cloud</a>.</li>
<li>The repository contains three main template files; modify these, but keep their names:</li>
</ol>
<ul>
<li>a template RMarkdown document, <code>report.Rmd</code>, that you should expand with your answers and solutions for this project assignment,</li>
<li>a template <code>analysis.R</code> for long-running analysis code. The use of the <code>analysis.R</code> file is optional, and you should <em>not</em> <code><a href="https://rdrr.io/r/base/source.html" class="external-link">source()</a></code> it in the <code>report.Rmd</code> file; instead, only use it for long running analysis code, following the examples for saving the results, and then reading them back in the <code>report.Rmd</code> file.</li>
<li>a template <code>functions.R</code> file where you should place function definitions needed by <code>report.Rmd</code> and/or <code>analysis.R</code>, with associated documentation.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Code that display results (e.g. as tables or figures) must be placed as code chunks in <code>report.Rmd</code>.</li>
<li>Code in the template files includes an example for how to save and load results of long-running calculations</li>
<li>Code chunks are included in <code>report.Rmd</code> that loads the function definitions from <code>functions.R</code> (your own function definitions).</li>
<li>Two appendix code chunks are included that displays the code from <code>functions.R</code> and <code>analysis.R</code> without running it.</li>
<li>Use the <code>styler</code> package Addin for restyling code for better and consistent readability works for both <code>.R</code> and <code>.Rmd</code> files.</li>
<li>As in project 1, use <code>echo=TRUE</code> for analysis code chunks, and <code>echo=FALSE</code> for table display and plot generating code chunks.</li>
</ol>
<p>The assignment is submitted by pushing your work to the github repository before your submission deadline. Make it a habit to commit&amp;push to github regularly, e.g. at least at the end of every coding session.</p>
<p>Make sure you include your name, student number, and github username in both <code>report.Rmd</code>, <code>functions.R</code>, and <code>analysis.R</code>. When submitting, also include a generated html version of the report, with file name <code>report.html</code>. Normally, generated images are automatically included in the html file itself; otherwise they need to be added to the repository as well.</p>
<p>The submission deadline is Monday 18 April 2022, at 16:00 (Edinburgh time). See the Assessment page on Learn for extensions and late submission penalty details.</p>
<p>The project will be marked as a whole, between <span class="math inline">\(0\)</span> and <span class="math inline">\(40\)</span>, using the marking guide posted on Learn.</p>
<div style="page-break-after: always;"></div>
<div class="section level2">
<h2 id="scottish-weather-data">Scottish weather data<a class="anchor" aria-label="anchor" href="#scottish-weather-data"></a>
</h2>
<p>The Global Historical Climatology Network at <a href="https://www.ncei.noaa.gov/products/land-based-station/global-historical-climatology-network-daily" class="external-link uri">https://www.ncei.noaa.gov/products/land-based-station/global-historical-climatology-network-daily</a> provides historical weather data collected from all over the globe. A subset of the daily resolution data set is available in the <code>StatCompLab package</code> containing data from eight weather stations in Scotland, covering the time period from 1 January 1960 to 31 December 2018. Some of the measurements are missing, either due to instrument problems or data collection issues. See <code>Tutorial07</code> for an exploratory introduction to the data, and techniques for wrangling the data.</p>
<p>Load the data with</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ghcnd_stations</span>, package <span class="op">=</span> <span class="st">"StatCompLab"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ghcnd_values</span>, package <span class="op">=</span> <span class="st">"StatCompLab"</span><span class="op">)</span></code></pre></div>
<p>The <code>ghcnd_stations</code> data frame has 5 variables:</p>
<ul>
<li>
<code>ID</code>: The identifier code for each station</li>
<li>
<code>Name</code>: The humanly readable station name</li>
<li>
<code>Latitude</code>: The latitude of the station location, in degrees</li>
<li>
<code>Longitude</code>: The longitude of the station location, in degrees</li>
<li>
<code>Elevation</code>: The station elevation, in metres above sea level</li>
</ul>
<p>The station data set is small enough that you can view the whole thing, e.g. with <code>knitr::kable(ghcnd_stations)</code>. You can try to find some of the locations on a map (Google maps an other online map systems can usually interpret latitude and longitude searches).</p>
<!--


-->
<p>The <code>ghcnd_values</code> data frame has 7 variables:</p>
<ul>
<li>
<code>ID</code>: The station identifier code for each observation</li>
<li>
<code>Year</code>: The year the value was measured</li>
<li>
<code>Month</code>: The month the value was measured</li>
<li>
<code>Day</code>: The day of the month the value was measured</li>
<li>
<code>DecYear</code>: “Decimal year”, the measurement date converted to a fractional value, where whole numbers correspond to 1 January, and fractional values correspond to later dates within the year. This is useful for both plotting and modelling.</li>
<li>
<code>Element</code>: One of “TMIN” (minimum temperature), “TMAX” (maximum temperature), or “PRCP” (precipitation), indicating what each value in the <code>Value</code> variable represents</li>
<li>
<code>Value</code>: Daily measured temperature (in degrees Celsius) or precipitation (in mm)</li>
</ul>
</div>
<div class="section level2">
<h2 id="seasonal-variability">Seasonal variability<a class="anchor" aria-label="anchor" href="#seasonal-variability"></a>
</h2>
<p>Note: For this first half of the assignment, you can essentially ignore that some of the data is missing; when defining averages, just take the average of whatever observations are available in the relevant data subset. If you construct averages with <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise()</a></code> &amp; <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code>, that will essentially happen by itself.</p>
<div class="section level3">
<h3 id="is-precipitation-seasonally-varying">Is precipitation seasonally varying?<a class="anchor" aria-label="anchor" href="#is-precipitation-seasonally-varying"></a>
</h3>
<p>The daily precipitation data is more challenging to model than temperature, because of the mix of zeros and positive values. Plot some of the data to show the behaviour, e.g. during one of the years, for all the stations. For temperature, the seasonal effects are clear; it’s generally colder in the winter than in the summer. For precipitation, the seasonal variability is less clear.</p>
<p>Let winter be <span class="math inline">\(\{\text{Jan, Feb, Mar, Oct, Nov, Dec}\}\)</span>, and let summer be <span class="math inline">\(\{\text{Apr, May, Jun, Jul, Aug, Sep}\}\)</span>. For easier code structure, add this season information to the weather data object.</p>
<p>Construct a Monte Carlo permutation test for the hypotheses <span class="math display">\[
\begin{aligned}
H_0:&amp;\text{The rainfall distribution is the same in winter as in summer} \\
H_1:&amp;\text{The winter and summer distributions have different expeced values}
\end{aligned}
\]</span> Use <span class="math inline">\(T=|\text{winter average} - \text{summer average}|\)</span> as test statistic, and compute separate p-values for each weather station, and their respective Monte Carlo standard deviations.</p>
<p>Collect the results into a suitable data structure, present and discuss the results.</p>
</div>
<div class="section level3">
<h3 id="how-often-does-it-rain">How often does it rain?<a class="anchor" aria-label="anchor" href="#how-often-does-it-rain"></a>
</h3>
<p>Using the same technique as for the rainfall amounts, test the hypotheses <span class="math display">\[
\begin{aligned}
H_0:&amp;\text{The daily probability of rainfall is the same in winter as in summer} \\
H_1:&amp;\text{The daily probability of rainfall is different in winter and in summer}
\end{aligned}
\]</span> Use <span class="math inline">\(T=|\text{winter empirical nonzero proportion} - \text{summer empirical nonzero proportion}|\)</span> as test statistic.</p>
<p>Collect the results into a suitable data structure, present and discuss the results.</p>
<p>For structured code and reduced computation time, consider adapting the previous code to handle both tests at the same time; you don’t need to keep the code for the two tests separate, and you can discuss the results jointly.</p>
</div>
</div>
<div class="section level2">
<h2 id="spatial-weather-prediction">Spatial weather prediction<a class="anchor" aria-label="anchor" href="#spatial-weather-prediction"></a>
</h2>
<p>For this second half of the project, you should first construct a version of the data set with monthly averaged precipitation values.</p>
<div class="section level3">
<h3 id="estimation-and-prediction">Estimation and prediction<a class="anchor" aria-label="anchor" href="#estimation-and-prediction"></a>
</h3>
<p>Define and estimate a monthly precipitation model for Scotland. Use covariates such as the spatial coordinates, elevation, and suitable <span class="math inline">\(\cos\)</span> and <span class="math inline">\(\sin\)</span> functions to capture seasonal variability. A long term climate trend covariate may also be useful.</p>
<p>Organise your code so that you can easily change the input data without having to change the estimation code and predict for new locations and times. You’ll need to be able to run the estimation for different subsets of the data, as well as for manually constructed covariate values, e.g. to illustrate prediction at a new location not present in the available weather data.</p>
<p>Present and discuss your modelling choices, and the results of the model estimation.</p>
</div>
<div class="section level3">
<h3 id="assessment">Assessment<a class="anchor" aria-label="anchor" href="#assessment"></a>
</h3>
<p>We are interested in how well the model is able to predict precipitation at new locations. Construct a stratified cross-validation that groups the data by weather station, and computes the prediction scores for each station, as well as the overall cross-validated average scores, aggregated to the 12 months of the year.</p>
<p>Present and discuss the results of the score assessments, for both Squared Error and Dawid-Sebastiani scores. Is the model equally good at predicting the different stations? Is the prediction accuracy the same across the whole year?</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Finn Lindgren.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
