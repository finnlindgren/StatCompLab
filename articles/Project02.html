<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>StatComp Project 2 (2020/21): Scottish weather • StatCompLab</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="StatComp Project 2 (2020/21): Scottish weather">
<meta property="og:description" content="Statistical Computing (2020/21): Coursework project 2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">StatCompLab</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Lab01.html">Lab01</a>
    </li>
    <li>
      <a href="../articles/Lab02.html">Lab02</a>
    </li>
    <li>
      <a href="../articles/Lab03.html">Lab03</a>
    </li>
    <li>
      <a href="../articles/Project01.html">StatComp Project 1 (2020/21): Numerical statistics</a>
    </li>
    <li>
      <a href="../articles/Project01Hints.html">Project 01 Hints</a>
    </li>
    <li>
      <a href="../articles/Project02.html">StatComp Project 2 (2020/21): Scottish weather</a>
    </li>
    <li>
      <a href="../articles/Project02Hints.html">Project 02 Hints</a>
    </li>
    <li>
      <a href="../articles/Tutorial01.html">Tutorial 01: R and linear models</a>
    </li>
    <li>
      <a href="../articles/Tutorial01Solutions.html">Tutorial 01: R and linear models (solutions)</a>
    </li>
    <li>
      <a href="../articles/Tutorial03.html">Tutorial 03: Monte Carlo integration</a>
    </li>
    <li>
      <a href="../articles/Tutorial03Solutions.html">Tutorial 03: Monte Carlo integration (solutions)</a>
    </li>
    <li>
      <a href="../articles/Tutorial04.html">Tutorial 04: Uncertainty and integration</a>
    </li>
    <li>
      <a href="../articles/Tutorial04Solutions.html">Tutorial 04: Uncertainty and integration (solutions)</a>
    </li>
    <li>
      <a href="../articles/Tutorial06.html">Tutorial 06: Prediction assessment with proper scores</a>
    </li>
    <li>
      <a href="../articles/Tutorial06Solutions.html">Tutorial 06: Prediction assessment with proper scores (solutions)</a>
    </li>
    <li>
      <a href="../articles/Tutorial07.html">Tutorial 07: Data wrangling and cross validation</a>
    </li>
    <li>
      <a href="../articles/Tutorial07Solutions.html">Tutorial 07: Data wrangling and cross validation (solutions)</a>
    </li>
    <li>
      <a href="../articles/Tutorial08.html">Tutorial 08: Floating point computations and least squares</a>
    </li>
    <li>
      <a href="../articles/Tutorial08Solutions.html">Tutorial 08: Floating point computations and least squares (solutions)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/finnlindgren/StatCompLab/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Project02_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>StatComp Project 2 (2020/21): Scottish weather</h1>
                        <h4 class="author">Finn Lindgren</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/finnlindgren/StatCompLab/blob/master/vignettes/Project02.Rmd"><code>vignettes/Project02.Rmd</code></a></small>
      <div class="hidden name"><code>Project02.Rmd</code></div>

    </div>

    
    
<p>This document can either be accessed in html form on (<a href="https://finnlindgren.github.io/StatCompLab/" class="uri">https://finnlindgren.github.io/StatCompLab/</a>), as a vignette in <code>StatCompLab</code> version 0.9.0 or later, with <code><a href="../articles/Project02.html">vignette("Project02", "StatCompLab")</a></code>, or in pdf format on Learn.</p>
<ol style="list-style-type: decimal">
<li>You have been assigned a <code>project02-username</code> repository on <a href="https://github.com/StatComp20/">https://github.com/StatComp20/</a>. Use <code>git</code> to <em>clone</em> the repository (either to <a href="https://rstudio.cloud">https://rstudio.cloud</a> or your own computer) in the same way as the <code>lab02-username</code> repository in Lab 2. Do not confuse your own repository with the <code>project02-template</code> repository.</li>
<li>The repository contains three template files; modify these, and keep their names:</li>
</ol>
<ul>
<li>a template RMarkdown document, <code>report.Rmd</code>, that you should expand with your answers and solutions for this project assignment,</li>
<li>a template <code>my_code.R</code> for long-running analysis code</li>
<li>a template <code>my_functions.R</code> file where you can place function defintions needed by <code>report.Rmd</code> and/or <code>my_code.R</code>
</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Code that display results (e.g. as tables or figures) must be placed as code chunks in <code>report.Rmd</code>.</li>
<li>Code in the template files includes an example for how to save and load results of long-running calculations</li>
<li>A <code>my-setup</code> code chunk is included in <code>report.Rmd</code> that runs the function definitions from <code>my_functions.R</code>.</li>
<li>Two appendix code chunk are included that displays the code from <code>my_functions.R</code> and <code>my_code.R</code> without running it.</li>
<li>Use the <code>styler</code> package Addin for restyling code for better and consistent readability works for both <code>.R</code> and <code>.Rmd</code> files.</li>
</ol>
<p>The assignment is submitted by pushing your work to the github repository before your submission deadline. Make it a habit to commit&amp;push to github regularly, e.g. at least at the end of every coding session.</p>
<p>Make sure you include your name, student number, and github username in both <code>report.Rmd</code>, <code>my_functions.R</code>, and <code>my_code.R</code>. When submitting, also include a generated html version of the report, with filename <code>report.html</code>. Normally, generated images are automatically included in the html file itself; otherwise they need to be added to the repository as well.</p>
<p>The submission deadline is Friday 9 April 2021, at 16:00 (Edinburgh time). See the Assessment page on Learn for extensions and late submission penalty details.</p>
<p>The project will be marked as a whole, between <span class="math inline">\(0\)</span> and <span class="math inline">\(40\)</span>, using the marking guide posted on Learn.</p>
<div style="page-break-after: always;"></div>
<div id="scottish-weather-data" class="section level1">
<h1 class="hasAnchor">
<a href="#scottish-weather-data" class="anchor"></a>Scottish weather data</h1>
<p>The Global Historical Climatology Network at <a href="https://www.ncdc.noaa.gov/data-access/land-based-station-data/land-based-datasets/global-historical-climatology-network-ghcn" class="uri">https://www.ncdc.noaa.gov/data-access/land-based-station-data/land-based-datasets/global-historical-climatology-network-ghcn</a> provides historical weather data collected from all over the globe. A subset of the daily resolution data set (see <a href="https://www.ncdc.noaa.gov/ghcn-daily-description" class="uri">https://www.ncdc.noaa.gov/ghcn-daily-description</a>) is available in the <code>StatCompLab package</code> (from version 0.7.0) containing data from eight weather stations in Scotland, covering the time period from 1 January 1960 to 31 December 2018. Some of the measurements are missing, either due to instrument problems or data collection issues. See <code>Tutorial07</code> for an exploratory introduction to the data, and techniques for wrangling the data.</p>
<p>Load the data with</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">ghcnd_stations</span>, package <span class="op">=</span> <span class="st">"StatCompLab"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">ghcnd_values</span>, package <span class="op">=</span> <span class="st">"StatCompLab"</span><span class="op">)</span></code></pre></div>
<p>The <code>ghcnd_stations</code> data frame has 5 variables:</p>
<ul>
<li>
<code>ID</code>: The identifier code for each station</li>
<li>
<code>Name</code>: The humanly readable station name</li>
<li>
<code>Latitude</code>: The latitude of the station location, in degrees</li>
<li>
<code>Longitude</code>: The longitude of the station location, in degrees</li>
<li>
<code>Elevation</code>: The station elevation, in metres above sea level</li>
</ul>
<p>The station data set is small enough that you can view the whole thing, e.g. with <code><a href="https://rdrr.io/pkg/knitr/man/kable.html">knitr::kable(ghcnd_stations)</a></code>. You can try to find some of the locations on a map (google maps an other online map systems can usually interpret latitude and longitude searches).</p>
<!--


-->
<p>The <code>ghcnd_values</code> data frame has 7 variables:</p>
<ul>
<li>
<code>ID</code>: The station identifier code for each observation</li>
<li>
<code>Year</code>: The year the value was measured</li>
<li>
<code>Month</code>: The month the value was measured</li>
<li>
<code>Day</code>: The day of the month the value was measured</li>
<li>
<code>DecYear</code>: “Decimal year”, the measurement date converted to a fractional value, where whole numbers correspond to 1 January, and fractional values correspond to later dates within the year. This is useful for both plotting and modelling.</li>
<li>
<code>Element</code>: One of “TMIN” (minimum temperature), “TMAX” (maximum temperature), or “PRCP” (precipitation), indicating what each value in the <code>Value</code> variable represents</li>
<li>
<code>Value</code>: Daily measured temperature (in degrees Celsius) or precipitation (in mm)</li>
</ul>
</div>
<div id="climate-trends-and-variability" class="section level1">
<h1 class="hasAnchor">
<a href="#climate-trends-and-variability" class="anchor"></a>Climate trends and variability</h1>
<p>Note: For this first half of the assignment, you should essentially ignore the missing data; when defining monthly averages, just take the average of whatever observations are available in each month. If you construct the averages with <code>group_by()</code> and <code>summarise()</code>&amp;<code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>, that will essentially happen by itself.</p>
<div id="monthly-trends" class="section level2">
<h2 class="hasAnchor">
<a href="#monthly-trends" class="anchor"></a>Monthly trends</h2>
<p>In Tutorial07, you looked at annual averages. Now, aggregate the data to monthly averages instead, and estimate the long-term temporal trend in <code>TMIN</code> for each month, for each weather station. (You can use a for-loop to iterate over the months when estimating the trend.)</p>
<p>Collect the results into a suitable data structure, and draw a figure that shows how the climate trend varies across the year, for each station (use <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> or similar).</p>
<p>Discuss the results.</p>
<p>Note: When presenting the results, you may choose to scale the estimates to more a more humanly interpretable scale, such as “change per decade” (multiply by 10) or “change per century” (multiply by 100), instead of the “change per year” that a basic analysis provides. Alternatively, suitable scaling can be applied to the <code>Year</code> covariate before using it in the models.</p>
</div>
<div id="seasonally-varying-variability" class="section level2">
<h2 class="hasAnchor">
<a href="#seasonally-varying-variability" class="anchor"></a>Seasonally varying variability</h2>
<p>Is the temperature variability the same for each month of the year?</p>
<p>Choose a weather station, and for each month, perform a randomisation test for whether the the variance of the daily <code>TMIN</code> residuals from the monthly averages is larger than the overall residual variance. Define the residuals as <span class="math inline">\(R_t = T_t - \overline{T}_{m(t)}\)</span>, where <span class="math inline">\(T_t\)</span> is <code>TMIN</code> at time <span class="math inline">\(t\)</span>, and <span class="math inline">\(\overline{T}_{m(t)}\)</span> is the average TMIN-value in the month of time <span class="math inline">\(t\)</span>.</p>
<p>Present and discuss the results.</p>
<p>Notes:</p>
<ul>
<li>The monthly averages are the same as for the trend estimation, i.e. you need to group by both <code>Year</code> and <code>Month</code> before calling <code>summarise()</code>.</li>
<li>The hypotheses to be tested are of the form <span class="math display">\[
\begin{aligned}
H_0:&amp;\text{The residual variance is the same for all months of the year}\\
H_1:&amp;\text{The residual variance for January is higher than the overall variance}
\end{aligned}
\]</span> and similarly for February, March, etc.</li>
</ul>
</div>
</div>
<div id="spatial-weather-prediction" class="section level1">
<h1 class="hasAnchor">
<a href="#spatial-weather-prediction" class="anchor"></a>Spatial weather prediction</h1>
<p>Note: For this second half of the project, you should remove all data points from days that have a missing value in one or more of the stations. After rearranging the data to have one temperature column for each station, this can be done with the <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> function.</p>
<div id="estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#estimation" class="anchor"></a>Estimation</h2>
<p>Choose a weather station, and make code for estimating a linear model that uses daily <code>TMAX</code> at the other weather stations as covariates for <code>TMAX</code> at the chosen station. Present and discuss the result of estimating a separate model for each month of the year.</p>
<p>Organise your code so that you can easily change the input data without having to change the estimation code. You’ll need to be able to run the estimation for different subsets of the data.</p>
<p>Hint: Start by considering what structure would be easiest to have the data in, and then use combinations of <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code>, <code>select()</code> and related functions to achieve that. The <code>pivot_wider</code> can be used to create one data column for each station.</p>
</div>
<div id="assessment" class="section level2">
<h2 class="hasAnchor">
<a href="#assessment" class="anchor"></a>Assessment</h2>
<p>For each month, use 10-fold randomised cross-validation to estimate the expected Absolute Error and Dawid-Sebastiani scores for the <code>TMAX</code> predictions at the chosen station.</p>
<p>Present and discuss the result.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Finn Lindgren.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
