<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="StatCompLab">
<title>StatComp Project 2 (2021/22): Hints • StatCompLab</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="StatComp Project 2 (2021/22): Hints">
<meta property="og:description" content="StatCompLab">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">StatCompLab</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">21.9.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Project01.html">StatComp Project 1 (2021/22): Simulation and sampling</a>
    <a class="dropdown-item" href="../articles/Project01Hints.html">StatComp Project 1 (2021/22): Hints</a>
    <a class="dropdown-item" href="../articles/Project02.html">StatComp Project 2 (2021/22): Scottish weather</a>
    <a class="dropdown-item" href="../articles/Project02Hints.html">StatComp Project 2 (2021/22): Hints</a>
    <a class="dropdown-item" href="../articles/Tutorial01.html">Tutorial 01: R and linear models</a>
    <a class="dropdown-item" href="../articles/Tutorial01Solutions.html">Tutorial 01: R and linear models (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial02.html">Tutorial 02: Optimization</a>
    <a class="dropdown-item" href="../articles/Tutorial02Solutions.html">Tutorial 02: Optimization (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial03.html">Tutorial 03: Monte Carlo integration</a>
    <a class="dropdown-item" href="../articles/Tutorial03Solutions.html">Tutorial 03: Monte Carlo integration (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial04.html">Tutorial 04: Uncertainty and integration</a>
    <a class="dropdown-item" href="../articles/Tutorial04Solutions.html">Tutorial 04: Uncertainty and integration (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial06.html">Tutorial 06: Prediction assessment with proper scores</a>
    <a class="dropdown-item" href="../articles/Tutorial06Solutions.html">Tutorial 06: Prediction assessment with proper scores (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial07.html">Tutorial 07: Data wrangling and cross validation</a>
    <a class="dropdown-item" href="../articles/Tutorial07Solutions.html">Tutorial 07: Data wrangling and cross validation (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial08.html">Tutorial 08: Floating point computations and least squares</a>
    <a class="dropdown-item" href="../articles/Tutorial08Solutions.html">Tutorial 08: Floating point computations and least squares (solutions)</a>
    <a class="dropdown-item" href="../articles/Tutorial09.html">Tutorial 09: Bootstrap and Pareto smoothed importance sampling</a>
    <a class="dropdown-item" href="../articles/Tutorial09Solutions.html">Tutorial 09: Bootstrap and Pareto smoothed importance sampling (solutions)</a>
    <a class="dropdown-item" href="../articles/Project_Example.html">StatComp Project Example: Numerical statistics</a>
    <a class="dropdown-item" href="../articles/Project_Example_Solution.html">StatComp Project Example Solution: Numerical Statistics</a>
    <a class="dropdown-item" href="../articles/Quiz1Solution.html">Quiz 1 Solution (StatComp 2021/22)</a>
    <a class="dropdown-item" href="../articles/T4sol.html">Tutorial 04: Uncertainty and integration (full solution)</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/finnlindgren/StatCompLab/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>StatComp Project 2 (2021/22): Hints</h1>
                        <h4 data-toc-skip class="author">Finn Lindgren</h4>
            
            <h4 data-toc-skip class="date">2022-04-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/finnlindgren/StatCompLab/blob/HEAD/vignettes/Project02Hints.Rmd" class="external-link"><code>vignettes/Project02Hints.Rmd</code></a></small>
      <div class="d-none name"><code>Project02Hints.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="monte-carlo-standard-errors-and-confidence-intervals">Monte Carlo standard errors and confidence intervals<a class="anchor" aria-label="anchor" href="#monte-carlo-standard-errors-and-confidence-intervals"></a>
</h2>
<p>In plain Monte Carlo estimation of an expectation value, we can usually construct approximate confidence intervals by estimating the standard deviation of the estimator and construct an interval based on a Normal distribution for the estimator. However, this breaks down in some cases. For example, when using a randomisation test to estimate a p-value, the Normal approximation only works if the p-value <span class="math inline">\(p\)</span> or the number of samples <span class="math inline">\(N\)</span> are large enough, so that we actually observe non-zero counts. Fortunately, if we observe zero counts, we can construct a confidence interval using an exact method instead of relying on the Normal approximation.</p>
<div class="section level3">
<h3 id="monte-carlo-randomisation-test-variability">Monte Carlo randomisation test variability<a class="anchor" aria-label="anchor" href="#monte-carlo-randomisation-test-variability"></a>
</h3>
<p>Let <span class="math inline">\(p\)</span> be the unknown p-value, and <span class="math inline">\(X\sim\mathsf{Bin}(N,p)\)</span> be the random variable for how many times we observe a randomised test statistic as extreme as or more extreme than the observed test statistic. We observe <span class="math inline">\(X=x\)</span> and estimate the p-value with <span class="math inline">\(\widehat{p}=x/N\)</span>. Then <span class="math display">\[
\begin{aligned}
\mathsf{E}(X) &amp;= N p, \\
\mathsf{Var}(X) &amp;= N p (1 - p), \\
\mathsf{E}(\widehat{p}) &amp;= p, \\
\mathsf{Var}(\widehat{p}) &amp;= \frac{p(1-p)}{N} .
\end{aligned}
\]</span> We see that the variance decreases towards <span class="math inline">\(0\)</span> when <span class="math inline">\(p\rightarrow 0\)</span>. We can control the expectation of the absolute error. Due to Jensen’s inequality (you may or may not have heard of that!) <span class="math inline">\(\mathsf{E}(|\widehat{p}-p|)\leq\sqrt{\mathsf{E}[|\widehat{p}-p|^2]}=\sqrt{\mathsf{Var}(\widehat{p})}\leq\frac{1}{2\sqrt{N}}\)</span>, where the last step uses that the variance is maximised for <span class="math inline">\(p=1/2\)</span>. Thus, to guarantee <span class="math inline">\(\mathsf{E}(|\widehat{p}-p|)\leq \epsilon\)</span> for some <span class="math inline">\(\epsilon&gt;0\)</span>, we can choose <span class="math inline">\(N \geq \frac{1}{4 \epsilon^2}\)</span>.</p>
<p>The relative error has variance <span class="math inline">\(\mathsf{Var}\left[\frac{\widehat{p}-p}{p}\right]=\frac{1-p}{Np}\)</span> which goes to <span class="math inline">\(\infty\)</span> when <span class="math inline">\(p\rightarrow 0\)</span>, so we cannot control the relative error uniformly for all <span class="math inline">\(p\)</span> by increasing <span class="math inline">\(N\)</span>. We therefore need to be careful when assessing results for small values of <span class="math inline">\(p\)</span>.</p>
</div>
<div class="section level3">
<h3 id="normal-approximation">Normal approximation<a class="anchor" aria-label="anchor" href="#normal-approximation"></a>
</h3>
<p>When <span class="math inline">\(x&gt;0\)</span>, a basic approximate 95% confidence interval for <span class="math inline">\(p\)</span> is given by <span class="math display">\[
CI_p = \widehat{p} \pm z_{0.975} \sqrt{\frac{\widehat{p} (1-\widehat{p})}{N}}
= \frac{x}{N} \pm z_{0.975} \sqrt{\frac{x (N-x)}{N^3}} .
\]</span> With the approximation <span class="math inline">\(z_{0.975}\approx 2\)</span>, we can limit the interval width with <span class="math inline">\(4\sqrt{\frac{1}{4N}}\leq \epsilon\)</span> by taking <span class="math inline">\(N\geq \frac{4}{\epsilon^2}\)</span>. For <span class="math inline">\(\epsilon=0.02\)</span>, we get <span class="math inline">\(N\geq 10,000\)</span>.</p>
</div>
<div class="section level3">
<h3 id="exact-interval-for-x0">Exact interval for <span class="math inline">\(x=0\)</span><a class="anchor" aria-label="anchor" href="#exact-interval-for-x0"></a>
</h3>
<p>When the observed count is <span class="math inline">\(x=0\)</span>, we can go back to the definition of a confidence interval and how we can construct confidence intervals by “inverting a test”; the interval is taken to be the set for which the corresponding null hypothesis is not rejected.</p>
<p>Imagine that we reject the hypothesis <span class="math inline">\(H_0:p=p_0\)</span> for some <span class="math inline">\(p_0\)</span> if <span class="math inline">\(\mathsf{P}_X(X \leq x \mid p_0) &lt; 0.025\)</span> or <span class="math inline">\(\mathsf{P}_X(X \geq x \mid p_0) &lt; 0.025\)</span> (to nominally give equal tail error probability). When <span class="math inline">\(x=0\)</span>, the second probability is equal to <span class="math inline">\(1\)</span>, so that condition is never used. The test is therefore only rejected when <span class="math inline">\(\mathsf{P}_X(X = 0 \mid p_0) &lt; 0.025\)</span>. We solve for <span class="math inline">\(p_0\)</span>: <span class="math display">\[
\begin{aligned}
\mathsf{P}_X(X = 0 \mid p_0) = (1-p_0)^N &amp;&lt; 0.025 \\
1-p_0 &lt; 0.025^{1/N} \\
p_0 &gt; 1 - 0.025^{1/N} .
\end{aligned}
\]</span> The set of <span class="math inline">\(p_0\)</span> values for which the test is <em>not</em> rejected is <span class="math inline">\(p_0 \leq 1-0.025^{1/N}\)</span>, so when <span class="math inline">\(x=0\)</span> we can define the confidence interval for <span class="math inline">\(p\)</span> as <span class="math display">\[
CI_p = (0, 1-0.025^{1/N}) .
\]</span> To limit the width of such confidence intervals to at most some <span class="math inline">\(\epsilon\)</span>, we need <span class="math inline">\(1-0.025^{1/N}\leq \epsilon\)</span>, and <span class="math inline">\(N\geq \frac{\log(0.025)}{\log(1-\epsilon)}\)</span>. This grows much more slowly than <span class="math inline">\(\frac{4}{\epsilon^2}\)</span> when <span class="math inline">\(\epsilon\rightarrow 0\)</span>, so we can safely use the <span class="math inline">\(N\)</span> that’s required to bound the Normal approximation interval width and still fulfill the interval width criterion for the <span class="math inline">\(x=0\)</span> interval construction.</p>
</div>
</div>
<div class="section level2">
<h2 id="prediction-standard-deviations">Prediction standard deviations<a class="anchor" aria-label="anchor" href="#prediction-standard-deviations"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function can provide prediction standard errors for the linear predictor, with <code>se.fit</code>, but those are only half the story when predicting new data. The standard errors only include the uncertainty information about the linear predictor curve. For full prediction uncertainty, we need to take the observation variation into account, which <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> estimated via the variance of the residuals. Since the residuals for new observations is assumed to be conditionally independent of the predictor curve, the prediction variance can be estimated as the sum of the square of the prediction standard error and the residual variance, if the degrees of freedom is large. For the help text for <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> we see that when <code>se.fit=TRUE</code>, the output list contains the elements</p>
<ul>
<li>
<code>fit</code>: vector or matrix (depending on the <code>interval</code> argument)</li>
<li>
<code>se.fit</code>: standard error of predicted means</li>
<li>
<code>residual.scale</code>: residual standard deviations</li>
<li>
<code>df</code>: degrees of freedom for residual</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># When creating a tibble, the construct can use variables defined</span>
<span class="co"># first in the later variables; here we use x when constructing y:</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,
             y <span class="op">=</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Estimate a model:</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="co"># Compute prediction mean and standard deviations and add to df_pred:</span>
<span class="va">df_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, newdata <span class="op">=</span> <span class="va">df_pred</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">df_pred</span> <span class="op">&lt;-</span> <span class="va">df_pred</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">fit</span>,
         se.fit <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">se.fit</span>,
         sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pred</span><span class="op">$</span><span class="va">se.fit</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">pred</span><span class="op">$</span><span class="va">residual.scale</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_pred</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">se.fit</span>, colour <span class="op">=</span> <span class="st">"se.fit"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">sd</span>, colour <span class="op">=</span> <span class="st">"sd"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Std. deviations"</span><span class="op">)</span></code></pre></div>
<p><img src="Project02Hints_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>If we also ask for prediction intervals, we need to modify the code a bit. From comparing the interval width results from <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> with those from an interval assuming t-distributions, we see that they are identical up to floating point accuracy.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compute prediction mean and standard deviations and add to df_pred:</span>
<span class="va">df_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, newdata <span class="op">=</span> <span class="va">df_pred</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span>, interval <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span>
<span class="va">df_pred</span> <span class="op">&lt;-</span> <span class="va">df_pred</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">fit</span><span class="op">[</span>, <span class="st">"fit"</span><span class="op">]</span>,
         lwr <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">fit</span><span class="op">[</span>, <span class="st">"lwr"</span><span class="op">]</span>,
         upr <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">fit</span><span class="op">[</span>, <span class="st">"upr"</span><span class="op">]</span>,
         se.fit <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">se.fit</span>,
         sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pred</span><span class="op">$</span><span class="va">se.fit</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">pred</span><span class="op">$</span><span class="va">residual.scale</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_pred</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">upr</span> <span class="op">-</span> <span class="va">lwr</span> <span class="op">-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="fl">0.975</span>, <span class="va">pred</span><span class="op">$</span><span class="va">df</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="va">pred</span><span class="op">$</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Interval width difference"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">)</span></code></pre></div>
<p><img src="Project02Hints_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Finn Lindgren.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
